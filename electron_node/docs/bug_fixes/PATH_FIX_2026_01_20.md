# ğŸ”§ è·¯å¾„ä¿®å¤ - 2026-01-20

## é—®é¢˜è¯Šæ–­

### é—®é¢˜1: æ¨¡å—åŠ è½½å¤±è´¥ âŒ
```
Error: Cannot find module './electron-node/main/src/index.js'
```

**åŸå› **: `main/index.js` æœŸæœ›çš„è·¯å¾„ä¸å®é™…ç¼–è¯‘è¾“å‡ºä¸åŒ¹é…

### é—®é¢˜2: å‰ç«¯æ–‡ä»¶æ‰¾ä¸åˆ° âŒ
```
Failed to load URL: file:///.../main/renderer/dist/index.html with error: ERR_FILE_NOT_FOUND
```

**åŸå› **: `window-manager.ts` ä¸­çš„ç›¸å¯¹è·¯å¾„è®¡ç®—é”™è¯¯

---

## ä¿®å¤æ–¹æ¡ˆ

### ä¿®å¤1: main/index.js è·¯å¾„

**ä¿®æ”¹å‰**:
```javascript
module.exports = require('./electron-node/main/src/index.js');
```

**ä¿®æ”¹å**:
```javascript
module.exports = require('./main/src/index.js');
```

**åŸå› **: 
- tsconfig.main.json çš„ `outDir` è®¾ç½®ä¸º `./main`
- æºæ–‡ä»¶åœ¨ `main/src/**/*`
- ç¼–è¯‘è¾“å‡ºå®é™…åœ¨ `main/main/src/index.js`

---

### ä¿®å¤2: window-manager.ts å‰ç«¯è·¯å¾„

**ä¿®æ”¹å‰**:
```typescript
const distPath = path.join(__dirname, '../../renderer/dist/index.html');
```

**ä¿®æ”¹å**:
```typescript
// ç¼–è¯‘å: main/main/src/window-manager.js
// éœ€è¦: ../../../renderer/dist/index.html
const distPath = path.join(__dirname, '../../../renderer/dist/index.html');
```

**è·¯å¾„åˆ†æ**:
```
ç¼–è¯‘åä½ç½®: main/main/src/window-manager.js
__dirname:    main/main/src/
ç›®æ ‡ä½ç½®:     renderer/dist/index.html

æ­£ç¡®è·¯å¾„: ../../../renderer/dist/index.html
  1. ../ â†’ main/main/
  2. ../ â†’ main/
  3. ../ â†’ é¡¹ç›®æ ¹
  4. renderer/dist/index.html
```

---

## æ–‡ä»¶ç»“æ„

### ç¼–è¯‘å‰ï¼ˆæºä»£ç ï¼‰
```
electron-node/
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ index.js (å…¥å£è·³è½¬æ–‡ä»¶)
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ index.ts
â”‚       â””â”€â”€ window-manager.ts
â”œâ”€â”€ renderer/
â”‚   â””â”€â”€ dist/
â”‚       â””â”€â”€ index.html
â””â”€â”€ tsconfig.main.json (outDir: "./main")
```

### ç¼–è¯‘å
```
electron-node/
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ index.js (å…¥å£è·³è½¬æ–‡ä»¶) â† éœ€è¦ä¿®å¤
â”‚   â”œâ”€â”€ main/         â† ç¼–è¯‘è¾“å‡ºç›®å½•
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ index.js
â”‚   â”‚       â””â”€â”€ window-manager.js â† éœ€è¦ä¿®å¤è·¯å¾„
â”‚   â””â”€â”€ src/ (æºä»£ç )
â””â”€â”€ renderer/
    â””â”€â”€ dist/
        â””â”€â”€ index.html â† ç›®æ ‡æ–‡ä»¶
```

---

## ä¿®å¤æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ | åŸå›  |
|------|---------|------|
| `main/index.js` | `./electron-node/...` â†’ `./main/src/...` | ç¼–è¯‘è¾“å‡ºè·¯å¾„å˜æ›´ |
| `main/src/window-manager.ts` | `../../renderer/...` â†’ `../../../renderer/...` | ç¼–è¯‘åç›¸å¯¹è·¯å¾„è®¡ç®—é”™è¯¯ |

---

## æµ‹è¯•éªŒè¯

### 1. åº”ç”¨èƒ½å¯åŠ¨ âœ…
```powershell
npm start
# åº”è¯¥èƒ½çœ‹åˆ°Electronçª—å£æ‰“å¼€
```

### 2. å‰ç«¯èƒ½åŠ è½½ âœ…
```
ä¸»è¿›ç¨‹æ—¥å¿—åº”æ˜¾ç¤º:
âœ… Successfully loaded Vite dev server
æˆ–
Production mode: Loading built files
```

### 3. æ— æ¨¡å—é”™è¯¯ âœ…
```
å¯åŠ¨æ—¶ä¸åº”å‡ºç°:
- Cannot find module
- ERR_FILE_NOT_FOUND
```

---

## æ ¹æœ¬åŸå› åˆ†æ

è¿™äº›è·¯å¾„é—®é¢˜çš„æ ¹æœ¬åŸå› æ˜¯ **TypeScriptç¼–è¯‘è¾“å‡ºç›®å½•ç»“æ„ä¸é¢„æœŸä¸ç¬¦**ã€‚

### tsconfig.main.json é…ç½®
```json
{
  "compilerOptions": {
    "outDir": "./main",  â† è¾“å‡ºåˆ°mainç›®å½•
    ...
  },
  "include": [
    "main/src/**/*",     â† æºæ–‡ä»¶åœ¨main/src
    ...
  ]
}
```

**ç¼–è¯‘è¡Œä¸º**:
- æºæ–‡ä»¶: `main/src/index.ts`
- è¾“å‡ºæ–‡ä»¶: `main/` + `main/src/index.js` = `main/main/src/index.js`

**ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ**
TypeScriptä¿ç•™äº†æºæ–‡ä»¶çš„ç›®å½•ç»“æ„ï¼Œæ‰€ä»¥ `main/src/` çš„ç»“æ„è¢«ä¿ç•™åˆ°äº†è¾“å‡ºç›®å½• `main/` ä¸­ã€‚

---

## å…¶ä»–å¯èƒ½çš„ä¿®å¤æ–¹æ¡ˆï¼ˆæœªé‡‡ç”¨ï¼‰

### æ–¹æ¡ˆA: ä¿®æ”¹tsconfig.json
```json
{
  "compilerOptions": {
    "outDir": "./",       // è¾“å‡ºåˆ°å½“å‰ç›®å½•
    "rootDir": "./main/src"  // æŒ‡å®šæ ¹ç›®å½•
  }
}
```

**ä¼˜ç‚¹**: è¾“å‡ºç»“æ„æ›´æ¸…æ™°  
**ç¼ºç‚¹**: éœ€è¦å¤§å¹…ä¿®æ”¹ç°æœ‰é…ç½®ï¼Œé£é™©é«˜

### æ–¹æ¡ˆB: ä½¿ç”¨ç»å¯¹è·¯å¾„
```typescript
const projectRoot = path.resolve(__dirname, '../../..');
const distPath = path.join(projectRoot, 'renderer/dist/index.html');
```

**ä¼˜ç‚¹**: ä¸ä¾èµ–ç›¸å¯¹è·¯å¾„  
**ç¼ºç‚¹**: æ‰“åŒ…åå¯èƒ½å‡ºé—®é¢˜

---

## é¢„é˜²æªæ–½

### åœ¨CIä¸­æ·»åŠ è·¯å¾„æ£€æŸ¥
```javascript
// scripts/verify-paths.js
const fs = require('fs');
const path = require('path');

const requiredPaths = [
  'main/main/src/index.js',
  'renderer/dist/index.html',
];

for (const filePath of requiredPaths) {
  if (!fs.existsSync(filePath)) {
    console.error(`âŒ Required file missing: ${filePath}`);
    process.exit(1);
  }
}
console.log('âœ… All required files exist');
```

---

## æ€»ç»“

**ä¿®æ”¹æ–‡ä»¶**: 2ä¸ª
- `main/index.js` (1è¡Œ)
- `main/src/window-manager.ts` (1è¡Œ)

**ä¿®æ”¹åŸå› **: TypeScriptç¼–è¯‘è¾“å‡ºç›®å½•ç»“æ„å¯¼è‡´çš„ç›¸å¯¹è·¯å¾„é”™è¯¯

**éªŒè¯æ–¹æ³•**: `npm start` åº”è¯¥èƒ½æ­£å¸¸æ‰“å¼€Electronçª—å£å¹¶åŠ è½½å‰ç«¯

---

**ç°åœ¨åº”ç”¨åº”è¯¥èƒ½æ­£å¸¸å¯åŠ¨äº†ï¼** ğŸš€
