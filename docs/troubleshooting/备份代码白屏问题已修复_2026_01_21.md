# å¤‡ä»½ä»£ç ç™½å±é—®é¢˜å·²ä¿®å¤

**æ—¥æœŸ**: 2026-01-21 03:55  
**é—®é¢˜**: npm run build åä»ç„¶ç™½å±  
**çŠ¶æ€**: âœ… **å·²ä¿®å¤ä»£ç **

---

## âœ… ä¿®å¤å†…å®¹

### ä¿®æ”¹æ–‡ä»¶

**æ–‡ä»¶**: `window-manager.ts`  
**è·¯å¾„**: `D:\Programs\github\lingua_1\expired\lingua_1-main\electron_node\electron-node\main\src\window-manager.ts`

### ä¿®æ”¹å†…å®¹

**ç¬¬30è¡Œï¼Œä»**:
```typescript
const distPath = path.join(__dirname, '../../renderer/dist/index.html');
```

**æ”¹ä¸º**:
```typescript
const distPath = path.join(__dirname, '../../../../renderer/dist/index.html');
```

**åŸå› **: ç¼–è¯‘å `__dirname` æŒ‡å‘ `main/electron-node/main/src`ï¼Œéœ€è¦ 4 å±‚ `../` æ‰èƒ½å›åˆ°é¡¹ç›®æ ¹ç›®å½•

---

## ğŸš€ ç°åœ¨éœ€è¦åšçš„

### æ­¥éª¤1: é‡æ–°ç¼–è¯‘ main è¿›ç¨‹

```powershell
cd D:\Programs\github\lingua_1\expired\lingua_1-main\electron_node\electron-node
npm run build:main
```

**ç­‰å¾…ç¼–è¯‘å®Œæˆ**ï¼ˆçº¦10-20ç§’ï¼‰

---

### æ­¥éª¤2: é‡æ–°å¯åŠ¨èŠ‚ç‚¹ç«¯

```powershell
cd D:\Programs\github\lingua_1\expired\lingua_1-main\electron_node\electron-node
npm start
```

---

### æ­¥éª¤3: éªŒè¯

**Electronçª—å£åº”è¯¥æ˜¾ç¤º**:
- âœ… èŠ‚ç‚¹ç«¯ç•Œé¢ï¼ˆä¸å†ç™½å±ï¼‰
- âœ… å·¦ä¸Šè§’æ˜¾ç¤ºè¿æ¥çŠ¶æ€
- âœ… å¯ä»¥çœ‹åˆ°æœåŠ¡åˆ—è¡¨
- âœ… å¯ä»¥çœ‹åˆ°ç³»ç»Ÿèµ„æºä¿¡æ¯

---

## ğŸ“‹ å¦‚æœè¿˜æœ‰é—®é¢˜

### æ£€æŸ¥æ„å»ºæ˜¯å¦æˆåŠŸ

```powershell
# æ£€æŸ¥ç¼–è¯‘åçš„æ–‡ä»¶
Test-Path "D:\Programs\github\lingua_1\expired\lingua_1-main\electron_node\electron-node\main\electron-node\main\src\window-manager.js"
```

åº”è¿”å› `True`

---

### æŸ¥çœ‹æ—¥å¿—

**Electronçª—å£æ‰“å¼€åï¼ŒæŒ‰ `Ctrl+Shift+I` æ‰“å¼€å¼€å‘è€…å·¥å…·**

æŸ¥çœ‹ Console æ˜¯å¦æœ‰é”™è¯¯

---

### éªŒè¯è·¯å¾„æ˜¯å¦æ­£ç¡®

**å¯åŠ¨åæŸ¥çœ‹æ—¥å¿—**:
```powershell
Get-ChildItem "D:\Programs\github\lingua_1\expired\lingua_1-main\electron_node\electron-node\logs" -Filter "*.log" | Sort-Object LastWriteTime -Descending | Select-Object -First 1 | Get-Content -Tail 20
```

**åº”è¯¥çœ‹åˆ°**:
```json
{
  "msg":"Production mode: Loading built files",
  "distPath":"..../renderer/dist/index.html",
  "distExists":true
}
```

**ä¸åº”è¯¥çœ‹åˆ°**:
```json
{
  "msg":"Failed to load Vite dev server"
}
```

---

## ğŸ’¡ é—®é¢˜æ ¹æœ¬åŸå› å›é¡¾

### ä¸ºä»€ä¹ˆä¼šç™½å±ï¼Ÿ

1. **è·¯å¾„è®¡ç®—é”™è¯¯**
   - ä½¿ç”¨ `../../` åªèƒ½åˆ° `main/electron-node/`
   - æ— æ³•åˆ°è¾¾é¡¹ç›®æ ¹ç›®å½•çš„ `renderer/dist`

2. **distExists æ£€æŸ¥å¤±è´¥**
   - è·¯å¾„é”™è¯¯ â†’ æ‰¾ä¸åˆ°æ–‡ä»¶ â†’ `distExists = false`

3. **é”™è¯¯è¿›å…¥å¼€å‘æ¨¡å¼**
   - æ¡ä»¶ `isDev && !distExists` ä¸ºçœŸ
   - å°è¯•è¿æ¥ Vite (localhost:5173)

4. **Vite æœªè¿è¡Œ**
   - è¿æ¥å¤±è´¥ â†’ ç™½å±

5. **Fallback ä¹Ÿå¤±è´¥**
   - å°è¯• 5174 ç«¯å£ä¹Ÿå¤±è´¥ â†’ æŒç»­ç™½å±

---

## ğŸ¯ ä¿®å¤åçš„æµç¨‹

### æ­£ç¡®çš„å¯åŠ¨æµç¨‹

1. **æ£€æŸ¥ distPath**
   - `main/electron-node/main/src` + `../../../../` = é¡¹ç›®æ ¹
   - é¡¹ç›®æ ¹ + `renderer/dist/index.html` âœ…

2. **distExists = true**
   - æ–‡ä»¶ç¡®å®å­˜åœ¨

3. **è¿›å…¥ç”Ÿäº§æ¨¡å¼**
   - `else` åˆ†æ”¯ï¼šåŠ è½½æ„å»ºæ–‡ä»¶
   - `mainWindow.loadFile(distPath)`

4. **ç•Œé¢æ­£å¸¸æ˜¾ç¤º**
   - âœ… ä¸å†ç™½å±

---

## âœ… æ€»ç»“

| é—®é¢˜ | åŸå›  | ä¿®å¤ |
|------|------|------|
| **ç™½å±** | è·¯å¾„å±‚çº§ä¸è¶³ (../../) | æ”¹ä¸º ../../../../ |
| **å°è¯•è¿æ¥Vite** | distExists = false | è·¯å¾„ä¿®æ­£å = true |
| **åŠ è½½å¤±è´¥** | Viteæœªè¿è¡Œ | åŠ è½½æœ¬åœ°distæ–‡ä»¶ |

---

**ç«‹å³æ‰§è¡Œ**: 

```powershell
cd D:\Programs\github\lingua_1\expired\lingua_1-main\electron_node\electron-node
npm run build:main
npm start
```

**é¢„æœŸ**: ä¸å†ç™½å±ï¼
