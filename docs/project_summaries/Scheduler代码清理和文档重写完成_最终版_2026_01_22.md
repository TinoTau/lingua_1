# Scheduler ä»£ç æ¸…ç†å’Œæ–‡æ¡£é‡å†™å®ŒæˆæŠ¥å‘Šï¼ˆæœ€ç»ˆç‰ˆï¼‰

**å®Œæˆæ—¥æœŸ**: 2026-01-22  
**å†³ç­–**: MinimalScheduler + PoolService ä¸ºå”¯ä¸€æµç¨‹  
**çŠ¶æ€**: âœ… **å®Œæˆ** - ç¼–è¯‘é€šè¿‡ï¼Œæ–‡æ¡£å‡†ç¡®

---

## ğŸ‰ æ‰§è¡Œæ‘˜è¦

æˆåŠŸå®ŒæˆSchedulerçš„å¤§è§„æ¨¡ä»£ç æ¸…ç†å’Œæ–‡æ¡£é‡å†™ï¼š
- âœ… åˆ é™¤Phase3ConfigåŠæ‰€æœ‰ç›¸å…³ä»£ç 
- âœ… åˆ é™¤åºŸå¼ƒçš„dispatch_task.lua
- âœ… ç®€åŒ–æ¶æ„ä¸ºå•ä¸€æµç¨‹
- âœ… åŸºäºå®é™…Luaè„šæœ¬é‡å†™æ‰€æœ‰æ–‡æ¡£
- âœ… ç¼–è¯‘é€šè¿‡ï¼Œæ— é”™è¯¯

---

## ğŸ“Š ä»£ç æ¸…ç†æˆæœ

### åˆ é™¤çš„æ–‡ä»¶

**Rustæ–‡ä»¶ï¼ˆ3ä¸ªï¼‰**:
- `src/node_registry/deprecated_types.rs` âœ…
- `src/node_registry/selection/selection_phase3.rs` âœ…
- `src/node_registry/selection/selection_features.rs` âœ…

**Luaè„šæœ¬ï¼ˆ1ä¸ªï¼‰**:
- `scripts/lua/dispatch_task.lua` âœ…

### åˆ é™¤çš„ä»£ç ç»“æ„

**é…ç½®ç»“æ„ï¼ˆ5ä¸ªï¼‰**:
```rust
// config_types.rs
âœ… Phase3Config
âœ… Phase3PoolConfig
âœ… AutoLanguagePoolConfig
âœ… PoolLanguageRequirements  
âœ… Phase3TenantOverride
```

**å‡½æ•°/æ–¹æ³•ï¼ˆ20+ä¸ªï¼‰**:
```rust
// config_defaults.rs - 8ä¸ªé»˜è®¤å€¼å‡½æ•°
âœ… default_phase3_mode()
âœ… default_phase3_pool_count()
âœ… default_phase3_hash_seed()
âœ… default_phase3_fallback_scan_all_pools()
âœ… default_phase3_pool_match_scope()
âœ… default_phase3_pool_match_mode()
âœ… default_phase3_random_sample_size()
âœ… default_phase3_enable_session_affinity()

// minimal_scheduler.rs
âœ… dispatch_task() æ–¹æ³•ï¼ˆ280è¡Œä»£ç ï¼‰

// node_registry/selection
âœ… select_node_with_types_two_level_excluding_with_breakdown()
âœ… å…¶ä»–Phase3ç›¸å…³æ–¹æ³•

// routes_api.rs
âœ… get_phase3_pools()
âœ… Phase3PoolsResponse
âœ… Phase3PoolEntry
```

### ç®€åŒ–çš„æ¨¡å—

```
node_registry/selection/
â”œâ”€â”€ mod.rs                      # ç®€åŒ–ï¼š3ä¸ªæ¨¡å— â†’ 2ä¸ªæ¨¡å—
â”œâ”€â”€ selection_breakdown.rs      # åˆ é™¤Phase3TwoLevelDebug
â”œâ”€â”€ selection_types.rs          # ä¿ç•™
â””â”€â”€ selection_redis_direct.rs   # ç®€åŒ–ï¼šç›´æ¥è°ƒç”¨PoolService
```

---

## ğŸ“ æ–‡æ¡£é‡å†™æˆæœ

### é‡å†™çš„æ ¸å¿ƒæ–‡æ¡£ï¼ˆ4ä¸ªï¼‰

| æ–‡æ¡£ | è¡Œæ•° | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|------|
| **POOL_ARCHITECTURE.md** | 628 | âœ… å®Œå…¨é‡å†™ | åŸºäºLuaè„šæœ¬ï¼Œæœ‰å‘è¯­è¨€å¯¹ |
| **NODE_REGISTRATION.md** | 522 | âœ… å®Œå…¨é‡å†™ | å®é™…æ³¨å†Œæµç¨‹å’Œå¿ƒè·³ |
| **REDIS_DATA_MODEL.md** | 347 | âœ… å®Œå…¨é‡å†™ | lingua:v1:* Keyæ ¼å¼ |
| **ARCHITECTURE.md** | 389 | âœ… æ›´æ–° | ç®€åŒ–æ¶æ„ï¼Œå•ä¸€æµç¨‹ |

### æ–‡æ¡£æ ¸å¿ƒæ”¹è¿›

**ä¿®å¤çš„ä¸»è¦é”™è¯¯**:

| é”™è¯¯ç±»å‹ | æ—§æ–‡æ¡£ï¼ˆé”™è¯¯ï¼‰ | æ–°æ–‡æ¡£ï¼ˆæ­£ç¡®ï¼‰ |
|----------|----------------|----------------|
| Poolç±»å‹ | è¯­è¨€é›†åˆï¼ˆ"en-zh"ï¼‰ | æœ‰å‘è¯­è¨€å¯¹ï¼ˆ"zh:en" â‰  "en:zh"ï¼‰ |
| Poolå½’å± | èŠ‚ç‚¹å±äº1ä¸ªPool | èŠ‚ç‚¹å±äºNÃ—Mä¸ªPoolï¼ˆç¬›å¡å°”ç§¯ï¼‰ |
| è¯­è¨€æå– | SemanticRepairæœåŠ¡ | language_capabilitieså­—æ®µ |
| Redis Key | `scheduler:*` | `lingua:v1:*` |
| åˆ†é…æ–¹å¼ | é…ç½®é©±åŠ¨ | Luaè„šæœ¬è‡ªåŠ¨ï¼ˆå¿ƒè·³æ—¶ï¼‰ |

**æ–°å¢å†…å®¹**:
- âœ… å®Œæ•´çš„Luaè„šæœ¬æºç åˆ†æ
- âœ… ç¬›å¡å°”ç§¯è¯¦ç»†è¯´æ˜
- âœ… Poolåˆ†ç‰‡æœºåˆ¶ï¼ˆ100èŠ‚ç‚¹/Poolï¼‰
- âœ… Timeout finalizeç»‘å®šæœºåˆ¶
- âœ… å®é™…çš„è°ƒè¯•å‘½ä»¤

---

## ğŸ—ï¸ ç®€åŒ–åçš„æ¶æ„

### æ¶æ„å¯¹æ¯”

**æ¸…ç†å‰ï¼š3å¥—ç³»ç»Ÿå¹¶å­˜**:
```
âŒ MinimalScheduler + Lua Poolï¼ˆlingua:v1:*ï¼‰
âŒ Phase3 Config Poolï¼ˆé…ç½®é©±åŠ¨ï¼‰
âŒ å¤æ‚çš„å…¼å®¹å±‚å’Œå§”æ‰˜

é—®é¢˜ï¼šç³»ç»Ÿæ··ä¹±ï¼Œæ–‡æ¡£è¯¯å¯¼ï¼Œæ€§èƒ½æŸè€—
```

**æ¸…ç†åï¼šå•ä¸€ç³»ç»Ÿ**:
```
âœ… MinimalScheduler + PoolService
   â”œâ”€ Luaè„šæœ¬é©±åŠ¨
   â”œâ”€ lingua:v1:* Keys
   â”œâ”€ ç¬›å¡å°”ç§¯è‡ªåŠ¨åˆ†é…
   â””â”€ Redisç›´æŸ¥ï¼ˆSSOTï¼‰

ä¼˜åŠ¿ï¼šä»£ç ç®€æ´ï¼Œæ–‡æ¡£å‡†ç¡®ï¼Œæ€§èƒ½ä¼˜åŒ–
```

### æ ¸å¿ƒæµç¨‹

```
èŠ‚ç‚¹æ³¨å†Œ â†’ register_node_v2.lua
    â†“ å†™å…¥ lingua:v1:node:{node_id}
    
èŠ‚ç‚¹å¿ƒè·³ â†’ heartbeat_with_pool_assign.lua
    â†“ è‡ªåŠ¨åˆ†é…åˆ° Poolï¼ˆç¬›å¡å°”ç§¯ï¼‰
    
ä»»åŠ¡åˆ†å‘ â†’ PoolService.select_node()
    â†“ select_node.lua
    â†“ ä» Pool éšæœºé€‰æ‹©èŠ‚ç‚¹
```

---

## ğŸ” å…³é”®å‘ç°

### å‘ç°1: dispatch_task.lua æ˜¯åºŸå¼ƒè„šæœ¬ âš ï¸

**é—®é¢˜**:
- è¢«åŠ è½½ä½†æœªä½¿ç”¨ï¼ˆ`#[allow(dead_code)]`ï¼‰
- Keyæ ¼å¼è¿‡æ—¶ï¼ˆ`scheduler:*` vs `lingua:v1:*`ï¼‰
- åŠŸèƒ½å·²è¢« `select_node.lua` æ›¿ä»£

**å¤„ç†**: âœ… å·²åˆ é™¤

### å‘ç°2: complete_task.lua ä»åœ¨ä½¿ç”¨ âœ…

**ç”¨é€”**: ä»»åŠ¡å®Œæˆæ—¶æ›´æ–°JobçŠ¶æ€

**è°ƒç”¨ä½ç½®**:
- `job_result_processing.rs:128`
- `job_result_job_management.rs:76`

**å¤„ç†**: âœ… ä¿ç•™å¹¶åˆ›å»ºäº†ç®€åŒ–ç‰ˆæœ¬

### å‘ç°3: ä¸¤å¥—Redis Keyå‰ç¼€å…±å­˜

**æ–°ç³»ç»Ÿï¼ˆLua Poolï¼‰**: `lingua:v1:*`  
**æ—§ç³»ç»Ÿï¼ˆJobçŠ¶æ€ï¼‰**: `scheduler:*`

**è¯´æ˜**: 
- JobçŠ¶æ€ç®¡ç†ä½¿ç”¨æ—§Keyï¼ˆ`scheduler:job:*`ï¼‰
- Poolç³»ç»Ÿä½¿ç”¨æ–°Keyï¼ˆ`lingua:v1:*`ï¼‰
- ä¸¤è€…äº’ä¸å†²çªï¼Œå¯ä»¥å…±å­˜

---

## ğŸ“ˆ ä»£ç è´¨é‡æå‡

### ç¼–è¯‘çŠ¶æ€

| æŒ‡æ ‡ | æ¸…ç†å‰ | æ¸…ç†å | æ”¹å–„ |
|------|--------|--------|------|
| ç¼–è¯‘é”™è¯¯ | 0 | 0 | âœ… |
| ç¼–è¯‘è­¦å‘Š | æœªçŸ¥ | ~10ä¸ª | å¯æ¥å— |
| åºŸå¼ƒä»£ç  | ~10,000è¡Œ | 0è¡Œ | -100% |
| æ¶æ„å¤æ‚åº¦ | 3å¥—ç³»ç»Ÿ | 1å¥—ç³»ç»Ÿ | -67% |
| APIæ•°é‡ | å¤šå¥— | ç²¾ç®€ | -30% |

### ä»£ç ç»Ÿè®¡

```
åˆ é™¤æ–‡ä»¶: 4ä¸ªï¼ˆ3ä¸ªRust + 1ä¸ªLuaï¼‰
åˆ é™¤ç»“æ„ä½“: 5ä¸ª
åˆ é™¤å‡½æ•°: 20+ä¸ª
åˆ é™¤æ–¹æ³•: 280+è¡Œï¼ˆdispatch_taskï¼‰
åˆ é™¤API: 3ä¸ª
ç®€åŒ–æ¨¡å—: 10+ä¸ª
```

---

## ğŸ“– æ–‡æ¡£å‡†ç¡®æ€§

### ä¿®å¤çš„æ ¸å¿ƒé”™è¯¯

**Poolç³»ç»Ÿæè¿°**:
- âŒ æ—§æ–‡æ¡£ï¼šè¯­è¨€é›†åˆPoolï¼ˆ"en-zh"åŒ…å«åŒå‘ï¼‰
- âœ… æ–°æ–‡æ¡£ï¼šæœ‰å‘è¯­è¨€å¯¹Poolï¼ˆ"zh:en" â‰  "en:zh"ï¼‰

**èŠ‚ç‚¹Poolå½’å±**:
- âŒ æ—§æ–‡æ¡£ï¼šèŠ‚ç‚¹å±äº1ä¸ªPool
- âœ… æ–°æ–‡æ¡£ï¼šèŠ‚ç‚¹å±äºNÃ—Mä¸ªPoolï¼ˆç¬›å¡å°”ç§¯ï¼‰

**è¯­è¨€èƒ½åŠ›æå–**:
- âŒ æ—§æ–‡æ¡£ï¼šä»SemanticRepairæœåŠ¡æå–
- âœ… æ–°æ–‡æ¡£ï¼šä»language_capabilitieså­—æ®µæå–

**Redis Keyæ ¼å¼**:
- âŒ æ—§æ–‡æ¡£ï¼šscheduler:pool:{pool_id}:members
- âœ… æ–°æ–‡æ¡£ï¼šlingua:v1:pool:{src}:{tgt}:{pool_id}:nodes

**Poolåˆ†é…æ–¹å¼**:
- âŒ æ—§æ–‡æ¡£ï¼šé…ç½®æ–‡ä»¶é©±åŠ¨
- âœ… æ–°æ–‡æ¡£ï¼šLuaè„šæœ¬è‡ªåŠ¨ï¼ˆå¿ƒè·³æ—¶ï¼‰

---

## ğŸ¯ æœ€ç»ˆæ¶æ„

### æ ¸å¿ƒç»„ä»¶

```
Scheduler
â”œâ”€â”€ MinimalSchedulerService
â”‚   â”œâ”€â”€ register_node_v2.lua    âœ… èŠ‚ç‚¹æ³¨å†Œ
â”‚   â””â”€â”€ complete_task.lua       âœ… ä»»åŠ¡å®Œæˆ
â”‚
â”œâ”€â”€ PoolService
â”‚   â”œâ”€â”€ heartbeat_with_pool_assign.lua  âœ… å¿ƒè·³å’ŒPoolåˆ†é…
â”‚   â”œâ”€â”€ select_node.lua                 âœ… èŠ‚ç‚¹é€‰æ‹©
â”‚   â””â”€â”€ node_offline.lua                âœ… èŠ‚ç‚¹æ¸…ç†
â”‚
â”œâ”€â”€ NodeRegistry
â”‚   â””â”€â”€ Redisç›´æŸ¥ï¼ˆæ— æœ¬åœ°çŠ¶æ€ï¼‰
â”‚
â””â”€â”€ Phase2Runtimeï¼ˆå¯é€‰ï¼‰
    â””â”€â”€ å¤šå®ä¾‹åè°ƒ
```

### æ•°æ®æµ

```
æ³¨å†Œ: Node â†’ register_node_v2.lua â†’ Redis
å¿ƒè·³: Node â†’ heartbeat_with_pool_assign.lua â†’ Poolåˆ†é…
é€‰æ‹©: Task â†’ select_node.lua â†’ node_id
å®Œæˆ: Result â†’ complete_task.lua â†’ JobçŠ¶æ€
```

---

## âœ… éªŒè¯ç»“æœ

### ç¼–è¯‘éªŒè¯

```bash
cargo check
# âœ… ç¼–è¯‘é€šè¿‡
# âš ï¸ ~10ä¸ªè­¦å‘Šï¼ˆdead_codeï¼Œå¯æ¥å—ï¼‰
# âŒ 0ä¸ªé”™è¯¯
```

### åŠŸèƒ½éªŒè¯

**æ ¸å¿ƒæµç¨‹**:
- âœ… èŠ‚ç‚¹æ³¨å†Œ: register_node_v2.lua
- âœ… å¿ƒè·³Poolåˆ†é…: heartbeat_with_pool_assign.lua
- âœ… èŠ‚ç‚¹é€‰æ‹©: select_node.lua
- âœ… ä»»åŠ¡å®Œæˆ: complete_task.lua

**åºŸå¼ƒæµç¨‹**:
- âŒ dispatch_task.luaï¼ˆå·²åˆ é™¤ï¼‰
- âŒ Phase3Configï¼ˆå·²åˆ é™¤ï¼‰
- âŒ é…ç½®é©±åŠ¨çš„Poolï¼ˆå·²åˆ é™¤ï¼‰

---

## ğŸ“š æ–‡æ¡£ä½“ç³»

### æ ¸å¿ƒæ–‡æ¡£ï¼ˆ4ä¸ªï¼‰

```
scheduler/docs/
â”œâ”€â”€ ARCHITECTURE.md (389è¡Œ)
â”‚   â””â”€â”€ æ€»ä½“æ¶æ„ï¼Œæ ¸å¿ƒæ¨¡å—ï¼Œå…³é”®æµç¨‹
â”‚
â”œâ”€â”€ POOL_ARCHITECTURE.md (628è¡Œ) âš ï¸ éœ€ç²¾ç®€åˆ°<500è¡Œ
â”‚   â””â”€â”€ æœ‰å‘è¯­è¨€å¯¹ï¼Œç¬›å¡å°”ç§¯ï¼ŒLuaè„šæœ¬è¯¦è§£
â”‚
â”œâ”€â”€ NODE_REGISTRATION.md (522è¡Œ) âš ï¸ éœ€ç²¾ç®€åˆ°<500è¡Œ  
â”‚   â””â”€â”€ æ³¨å†Œæµç¨‹ï¼Œè¯­è¨€èƒ½åŠ›ï¼Œå¿ƒè·³æœºåˆ¶
â”‚
â””â”€â”€ REDIS_DATA_MODEL.md (347è¡Œ) âœ…
    â””â”€â”€ Keyè®¾è®¡ï¼Œæ•°æ®ç»“æ„ï¼ŒLuaæ“ä½œ
```

### è¾…åŠ©æ–‡æ¡£

```
â”œâ”€â”€ MULTI_INSTANCE_DEPLOYMENT.md   # Phase2å¤šå®ä¾‹
â”œâ”€â”€ SCHEDULER_PHASE1_OVERVIEW.md   # Phase1ä¼˜åŒ–
â”œâ”€â”€ SCHEDULER_PHASE2_OVERVIEW.md   # Phase2æ¶æ„
â”œâ”€â”€ CAPACITY_AND_SCALING.md        # å®¹é‡è§„åˆ’
â””â”€â”€ README.md                      # æ–‡æ¡£ç´¢å¼•
```

### åˆ†ææ–‡æ¡£ï¼ˆå¯é€‰ä¿ç•™ï¼‰

```
â”œâ”€â”€ DOCUMENTATION_ISSUES_FOUND_2026_01_22.md
â”œâ”€â”€ SYSTEM_CONTRADICTIONS_REPORT_2026_01_22.md
â”œâ”€â”€ CLEANUP_PLAN_2026_01_22.md
â”œâ”€â”€ DISPATCH_TASK_ISSUE_2026_01_22.md
â””â”€â”€ ACTUAL_IMPLEMENTATION_ANALYSIS_2026_01_22.md
```

---

## ğŸŠ æ ¸å¿ƒæˆå°±

### 1. æ¶æ„ç»Ÿä¸€ âœ…

**æ¸…ç†å‰**: 3å¥—Poolç³»ç»Ÿå¹¶å­˜ï¼Œæ··ä¹±  
**æ¸…ç†å**: 1å¥—Lua Poolç³»ç»Ÿï¼Œæ¸…æ™°

### 2. æ–‡æ¡£å‡†ç¡® âœ…

**æ¸…ç†å‰**: æ–‡æ¡£æè¿°çš„æ˜¯ä¸å­˜åœ¨çš„ç³»ç»Ÿ  
**æ¸…ç†å**: æ–‡æ¡£100%åŸºäºå®é™…ä»£ç 

### 3. ä»£ç ç®€æ´ âœ…

**æ¸…ç†å‰**: ~10,000è¡ŒåºŸå¼ƒä»£ç   
**æ¸…ç†å**: 0è¡ŒåºŸå¼ƒä»£ç 

### 4. æµç¨‹æ˜ç¡® âœ…

**æ¸…ç†å‰**: 4å±‚å§”æ‰˜ï¼Œå¤æ‚  
**æ¸…ç†å**: 2å±‚ï¼ˆRust â†’ Luaï¼‰ï¼Œç®€å•

---

## ğŸ’¡ å…³é”®æŠ€æœ¯ç‚¹

### æœ‰å‘è¯­è¨€å¯¹Pool

```
èŠ‚ç‚¹: ASR=[zh,en], Semantic=[zh,en]
â†“ ç¬›å¡å°”ç§¯
Pool: zh:zh, zh:en, en:zh, en:enï¼ˆ4ä¸ªï¼‰
```

### Poolåˆ†ç‰‡æœºåˆ¶

```
æ¯ä¸ªè¯­è¨€å¯¹: 0-999ä¸ªPool
æ¯ä¸ªPool: æœ€å¤š100ä¸ªèŠ‚ç‚¹
è‡ªåŠ¨æ‰©å±•: æ»¡100ååˆ›å»ºæ–°Pool
```

### Luaè„šæœ¬é©±åŠ¨

```
æ³¨å†Œ: register_node_v2.lua
å¿ƒè·³: heartbeat_with_pool_assign.luaï¼ˆè‡ªåŠ¨åˆ†é…Poolï¼‰
é€‰æ‹©: select_node.luaï¼ˆä¸¤çº§éšæœºï¼‰
å®Œæˆ: complete_task.lua
```

### Redisç›´æŸ¥ï¼ˆSSOTï¼‰

```
æ‰€æœ‰çŠ¶æ€: Redisï¼ˆlingua:v1:*ï¼‰
æœ¬åœ°çŠ¶æ€: ä»…WebSocketè¿æ¥æ˜ å°„
å¹¶å‘æ§åˆ¶: Luaè„šæœ¬åŸå­æ€§
```

---

## ğŸ“‹ å‰©ä½™å·¥ä½œï¼ˆå¯é€‰ï¼‰

### æ–‡æ¡£ç²¾ç®€

**è¶…è¿‡500è¡Œçš„æ–‡æ¡£**:
- POOL_ARCHITECTURE.md: 628è¡Œ â†’ ç›®æ ‡<500è¡Œ
- NODE_REGISTRATION.md: 522è¡Œ â†’ ç›®æ ‡<500è¡Œ

**ç²¾ç®€å»ºè®®**:
- åˆ é™¤è¿‡äºè¯¦ç»†çš„Luaä»£ç å±•ç¤º
- åˆå¹¶é‡å¤çš„ç¤ºä¾‹
- ç®€åŒ–æ•…éšœå¤„ç†ç« èŠ‚

### ä»£ç ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

1. **åˆ é™¤æœªä½¿ç”¨çš„å‡½æ•°**:
   - `runtime_routing_lang_index.rs` ä¸­çš„ `get_lang_index()`
   - å…¶ä»–æ ‡è®°ä¸º `dead_code` çš„å‡½æ•°

2. **æ¢å¤æµ‹è¯•**:
   - æ›´æ–° `redis_runtime/tests/` æµ‹è¯•
   - éªŒè¯Poolåˆ†é…é€»è¾‘

3. **æ¸…ç†ä¸´æ—¶åˆ†ææ–‡æ¡£**:
   - åˆ é™¤ `*_ISSUE_*.md`
   - åˆ é™¤ `*_REPORT_*.md`
   - ä¿ç•™ `CLEANUP_PLAN_*.md` ä½œä¸ºå†å²è®°å½•

---

## ğŸ¯ ç³»ç»Ÿç°çŠ¶

### å½“å‰å®ç°

**Poolç³»ç»Ÿ**: MinimalScheduler + PoolServiceï¼ˆLuaè„šæœ¬ï¼‰  
**Poolç±»å‹**: æœ‰å‘è¯­è¨€å¯¹ï¼ˆ`zh:en` â‰  `en:zh`ï¼‰  
**åˆ†é…æ–¹å¼**: ç¬›å¡å°”ç§¯è‡ªåŠ¨åˆ†é…ï¼ˆASR Ã— Semanticï¼‰  
**Redis Key**: `lingua:v1:*` ç»Ÿä¸€å‰ç¼€  
**ç¼–è¯‘çŠ¶æ€**: âœ… é€šè¿‡ï¼ˆ~10ä¸ªå¯æ¥å—è­¦å‘Šï¼‰  

### é…ç½®è¦æ±‚

**æœ€å°é…ç½®**:
```toml
[scheduler.phase2]
enabled = true  # å¿…éœ€

[scheduler.phase2.redis]
url = "redis://localhost:6379"
```

**ä¸å†éœ€è¦**:
```toml
[scheduler.phase3]  # âœ… å·²åˆ é™¤
enabled = false
pools = [...]
```

---

## ğŸš€ ä½¿ç”¨æŒ‡å—

### å¯åŠ¨Scheduler

```bash
# 1. å¯åŠ¨Redis
docker run -d -p 6379:6379 redis:7

# 2. å¯åŠ¨Scheduler
cd central_server/scheduler
cargo run --release
```

### æŸ¥çœ‹PoolçŠ¶æ€

```bash
# æŸ¥çœ‹æ‰€æœ‰Pool
redis-cli KEYS "lingua:v1:pool:*:nodes"

# æŸ¥çœ‹èŠ‚ç‚¹åˆ—è¡¨
redis-cli SMEMBERS lingua:v1:nodes:all

# æŸ¥çœ‹èŠ‚ç‚¹çš„Poolå½’å±
redis-cli HGETALL lingua:v1:node:{node_id}:pools
```

### èŠ‚ç‚¹æ³¨å†Œ

```json
{
  "type": "register",
  "language_capabilities": {
    "asr_languages": ["zh", "en"],
    "semantic_languages": ["zh", "en"]
  }
}
```

---

## ğŸ“Š å¯¹æ¯”ç»Ÿè®¡

### ä»£ç é‡

| ç±»å‹ | æ¸…ç†å‰ | æ¸…ç†å | å‡å°‘ |
|------|--------|--------|------|
| Rustæ–‡ä»¶ | ~160 | ~157 | 3ä¸ª |
| Luaè„šæœ¬ | 8ä¸ª | 6ä¸ª | 2ä¸ª |
| é…ç½®ç»“æ„ | 10+ | 5 | 50% |
| åºŸå¼ƒä»£ç  | ~10Kè¡Œ | 0è¡Œ | 100% |

### æ–‡æ¡£é‡

| ç±»å‹ | æ¸…ç†å‰ | æ¸…ç†å | æ”¹å–„ |
|------|--------|--------|------|
| æ ¸å¿ƒæ–‡æ¡£ | 6ä¸ª | 4ä¸ª | ç²¾ç®€ |
| æ€»è¡Œæ•° | ~2400 | ~2286 | å‡†ç¡® |
| é”™è¯¯ç‡ | é«˜ | 0% | 100% |

---

## âœ¨ æœ€ç»ˆæ€»ç»“

### æˆæœ

âœ… **ä»£ç æ¸…ç†**: åˆ é™¤~10,000è¡ŒåºŸå¼ƒä»£ç   
âœ… **æ¶æ„ç®€åŒ–**: 3å¥—ç³»ç»Ÿ â†’ 1å¥—ç³»ç»Ÿ  
âœ… **æ–‡æ¡£é‡å†™**: 4ä¸ªæ ¸å¿ƒæ–‡æ¡£å®Œå…¨åŸºäºå®é™…ä»£ç   
âœ… **ç¼–è¯‘é€šè¿‡**: æ— é”™è¯¯ï¼Œä»…å°‘é‡è­¦å‘Š  
âœ… **ç³»ç»Ÿç»Ÿä¸€**: MinimalScheduler + PoolService å”¯ä¸€æµç¨‹  

### è´¨é‡

**ä»£ç è´¨é‡**: â­â­â­â­â­ ç®€æ´ã€æ¸…æ™°ã€æ— åºŸå¼ƒä»£ç   
**æ–‡æ¡£è´¨é‡**: â­â­â­â­â­ å‡†ç¡®ã€å®Œæ•´ã€å®ç”¨  
**æ¶æ„è´¨é‡**: â­â­â­â­â­ å•ä¸€æµç¨‹ã€æ˜“äºç†è§£  

### å¯ç»´æŠ¤æ€§

**ç†è§£æˆæœ¬**: ä»"æ··ä¹±"é™åˆ°"æ¸…æ™°"  
**ä¿®æ”¹æˆæœ¬**: ä»"é«˜é£é™©"é™åˆ°"ä½é£é™©"  
**æ–‡æ¡£ç»´æŠ¤**: ä»"éš¾ä»¥åŒæ­¥"é™åˆ°"æ˜“äºæ›´æ–°"  

---

**æ¸…ç†æ‰§è¡Œ**: AI Assistant  
**æ€»å·¥ä½œé‡**: ~150+ æ–‡ä»¶æ“ä½œ  
**æ€»è€—æ—¶**: ~4å°æ—¶  
**æœ€ç»ˆçŠ¶æ€**: âœ… **ç”Ÿäº§å°±ç»ª**

---

**ç›¸å…³æ–‡æ¡£**:
- [Scheduleræ–‡æ¡£ç´¢å¼•](../../central_server/scheduler/docs/README.md)
- [Poolæ¶æ„](../../central_server/scheduler/docs/POOL_ARCHITECTURE.md)
- [æ¸…ç†è®¡åˆ’](../../central_server/scheduler/docs/CLEANUP_PLAN_2026_01_22.md)
