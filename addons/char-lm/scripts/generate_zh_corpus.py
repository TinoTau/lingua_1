# -*- coding: utf-8 -*-
"""
生成日常用语级别中文语料（句模板+槽位填充），仅用于小规模测试。
输出到 data/zh_sentences_template.txt，不会覆盖新闻语料。
正式训练用语料请使用 fetch_news_corpus.py 或 download_corpus.py 生成的 zh_sentences_large.txt。
"""
import os
import sys
import random

# 主语（扩充以增加字符多样性，利于 KenLM 模型体积与纠错覆盖）
SUBJ = ["我", "你", "他", "她", "我们", "你们", "他们", "大家", "咱", "人家", "谁", "它", "这边", "那边"]
# 时间
TIME = ["今天", "明天", "昨天", "现在", "早上", "晚上", "中午", "下午", "以后", "以前", "刚才", "一会儿", "最近", "平时", "周末", "春节", "夏天", "冬天", "秋天", "春天", "明年", "去年", "前天", "后天"]
# 动词
VERB = ["吃", "喝", "去", "来", "看", "听", "说", "做", "学", "写", "读", "买", "睡", "走", "坐", "用", "找", "等", "帮", "玩", "跑", "跳", "唱", "笑", "想", "忘", "记", "带", "拿", "放", "开", "关", "洗", "穿", "叫", "问", "答", "教", "试", "改", "修", "打", "踢", "送", "接", "搬", "推", "拉", "飞", "游", "骑", "种", "养", "喂", "煮", "炒", "切", "搬", "扫", "擦", "拖", "刷", "换", "借", "还", "付", "收", "花", "赚", "省", "存", "取", "寄", "收", "发", "传", "播", "录", "拍", "画", "编", "算", "测", "验", "查", "检", "办", "理", "管", "护", "保", "防", "治", "救", "扶", "抱", "握", "摸", "指", "按", "敲", "按", "点", "选", "挑", "定", "决", "认", "信", "疑", "怕", "爱", "恨", "喜", "厌", "愿", "肯", "敢", "能", "会", "该", "得", "须", "必"]
# 宾语/事物
OBJ = ["饭", "水", "茶", "书", "报纸", "电影", "音乐", "东西", "菜", "水果", "牛奶", "咖啡", "面", "汤", "手机", "电脑", "电视", "车", "钱", "票", "卡", "钥匙", "衣服", "鞋", "包", "笔", "纸", "本", "碗", "筷", "锅", "床", "桌", "椅", "门", "窗", "灯", "狗", "猫", "鸟", "鱼", "肉", "蛋", "米", "油", "盐", "糖", "药", "话", "事", "情", "理", "梦", "话", "信", "消息", "新闻", "节目", "比赛", "会议", "工作", "任务", "计划", "问题", "答案", "结果", "原因", "办法", "意见", "建议", "要求", "决定", "选择", "机会", "时间", "地方", "房间", "位置", "方向", "名字", "地址", "电话", "号码", "价格", "数量", "质量", "水平", "程度", "样子", "情况", "状态", "关系", "态度", "想法", "感觉", "印象", "经验", "知识", "技能", "习惯", "爱好", "兴趣", "目标", "理想", "希望", "愿望", "梦想", "幸福", "快乐", "痛苦", "困难", "麻烦", "危险", "安全", "健康", "幸福"]
# 地点
PLACE = ["家", "学校", "公司", "办公室", "房间", "饭店", "商店", "医院", "这里", "那里", "北京", "上海", "广州", "深圳", "杭州", "南京", "成都", "武汉", "西安", "机场", "车站", "地铁", "公交", "公园", "广场", "超市", "银行", "邮局", "图书馆", "体育馆", "电影院", "咖啡馆", "酒吧", "厨房", "浴室", "阳台", "楼梯", "电梯", "门口", "楼下", "楼上", "国外", "国内", "城里", "乡下", "海边", "山上", "路上", "车里", "飞机上", "火车上"]
# 形容词
ADJ = ["好", "大", "小", "多", "少", "新", "快", "慢", "对", "难", "容易", "重要", "清楚", "忙", "累", "美", "丑", "高", "矮", "胖", "瘦", "冷", "热", "暖", "凉", "甜", "苦", "辣", "酸", "咸", "香", "臭", "亮", "暗", "静", "闹", "乱", "脏", "净", "满", "空", "真", "假", "正", "反", "同", "异", "远", "近", "深", "浅", "厚", "薄", "粗", "细", "硬", "软", "强", "弱", "安全", "危险", "方便", "麻烦", "简单", "复杂", "便宜", "贵", "免费", "有用", "无聊", "有趣", "可怕", "可爱", "可怜", "可惜", "正确", "错误", "成功", "失败", "满意", "失望", "高兴", "难过", "紧张", "放松", "认真", "随便", "正式", "普通", "特别", "一般", "正常", "奇怪", "自然", "突然", "直接", "间接", "公开", "秘密", "主动", "被动", "积极", "消极", "乐观", "悲观"]
# 人物/身份
N_PERSON = ["老师", "学生", "朋友", "爸爸", "妈妈", "孩子", "医生", "同事", "老板", "爷爷", "奶奶", "外公", "外婆", "哥哥", "姐姐", "弟弟", "妹妹", "叔叔", "阿姨", "同学", "邻居", "司机", "厨师", "服务员", "警察", "律师", "工程师", "设计师", "作家", "歌手", "演员", "记者", "编辑", "经理", "秘书", "会计", "销售", "客户", "顾客", "观众", "读者", "用户", "乘客", "游客", "病人", "客人", "主人", "领导", "员工", "专家", "学者", "教授", "博士", "护士", "工人", "农民", "商人", "军人", "校长", "院长", "厂长"]
# 称谓
CALL = ["老师", "同学", "朋友", "先生", "女士", "大哥", "大姐", "老弟", "小妹", "叔叔", "阿姨", "爷爷", "奶奶"]

# 句模板：每项为 (模板字符串, 槽位名列表)。槽位名对应上面的变量名。
TEMPLATES = [
    ("{}想{}{}。", ["SUBJ", "VERB", "OBJ"]),
    ("{}要{}{}。", ["SUBJ", "VERB", "PLACE"]),
    ("{}天气很{}。", ["TIME", "ADJ"]),
    ("{}在{}{}{}。", ["SUBJ", "PLACE", "VERB", "OBJ"]),
    ("{}是{}。", ["SUBJ", "N_PERSON"]),
    ("这是{}。", ["OBJ"]),
    ("那是{}。", ["OBJ"]),
    ("{}有{}。", ["SUBJ", "OBJ"]),
    ("{}很{}。", ["SUBJ", "ADJ"]),
    ("{}和{}{}{}。", ["SUBJ", "SUBJ", "VERB", "OBJ"]),
    ("{}{}{}。", ["TIME", "SUBJ", "VERB", "OBJ"]),
    ("{}请{}。", ["SUBJ", "VERB"]),
    ("{}不{}。", ["SUBJ", "VERB"]),
    ("{}会{}。", ["SUBJ", "VERB"]),
    ("{}可以{}。", ["SUBJ", "VERB"]),
    ("{}应该{}。", ["SUBJ", "VERB"]),
    ("{}去{}{}。", ["SUBJ", "PLACE", "VERB"]),
    ("{}在{}。", ["SUBJ", "PLACE"]),
    ("{}的{}很{}。", ["SUBJ", "OBJ", "ADJ"]),
    ("{}想{}。", ["SUBJ", "VERB"]),
    ("{}要{}。", ["SUBJ", "OBJ"]),
    ("{}看{}。", ["SUBJ", "OBJ"]),
    ("{}听{}。", ["SUBJ", "OBJ"]),
    ("{}说{}。", ["SUBJ", "OBJ"]),
    ("{}做{}。", ["SUBJ", "OBJ"]),
    ("{}学{}。", ["SUBJ", "OBJ"]),
    ("{}写{}。", ["SUBJ", "OBJ"]),
    ("{}读{}。", ["SUBJ", "OBJ"]),
    ("{}买{}。", ["SUBJ", "OBJ"]),
    ("{}喝{}。", ["SUBJ", "OBJ"]),
    ("谢谢{}。", ["SUBJ"]),
    ("{}你好。", ["SUBJ"]),
    ("{}再见。", ["SUBJ"]),
    ("请问{}。", ["OBJ"]),
    ("{}怎么样？", ["OBJ"]),
    ("{}多少钱？", ["OBJ"]),
    ("{}什么时候？", ["VERB"]),
    ("{}为什么？", ["VERB"]),
    ("{}怎么办？", ["OBJ"]),
    ("{}很好。", ["OBJ"]),
    ("{}不错。", ["OBJ"]),
    ("{}没问题。", ["OBJ"]),
    ("{}可以。", ["VERB"]),
    ("{}不行。", ["VERB"]),
    ("{}不知道。", ["SUBJ"]),
    ("{}觉得{}。", ["SUBJ", "OBJ"]),
    ("{}喜欢{}。", ["SUBJ", "OBJ"]),
    ("{}需要{}。", ["SUBJ", "OBJ"]),
    ("{}知道{}。", ["SUBJ", "OBJ"]),
    ("{}明白。", ["SUBJ"]),
    ("{}清楚。", ["SUBJ"]),
    ("现在{}。", ["VERB"]),
    ("马上{}。", ["VERB"]),
    ("已经{}了。", ["VERB"]),
    ("正在{}。", ["VERB"]),
    ("还没{}。", ["VERB"]),
    ("一起{}。", ["VERB"]),
    ("再{}一下。", ["VERB"]),
    ("多{}一点。", ["VERB"]),
    ("少{}一点。", ["VERB"]),
]

SLOTS = {
    "SUBJ": SUBJ,
    "TIME": TIME,
    "VERB": VERB,
    "OBJ": OBJ,
    "PLACE": PLACE,
    "ADJ": ADJ,
    "N_PERSON": N_PERSON,
    "CALL": CALL,
}


def sentence():
    tpl, slot_names = random.choice(TEMPLATES)
    values = []
    for name in slot_names:
        pool = SLOTS.get(name, SUBJ)
        values.append(random.choice(pool))
    return tpl.format(*values)


def main():
    base = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
    out = os.path.join(base, "data", "zh_sentences_large.txt")
    os.makedirs(os.path.dirname(out), exist_ok=True)
    target = 800_000
    if len(sys.argv) > 1:
        try:
            target = int(sys.argv[1])
        except ValueError:
            pass
    print(f"Generating {target} lines (template-based) -> {out} (do not use for zh_sentences_large.txt)")
    seen = set()
    uniq = 0
    with open(out, "w", encoding="utf-8") as f:
        for i in range(target):
            s = sentence()
            if s not in seen:
                seen.add(s)
                uniq += 1
            f.write(s + "\n")
            if (i + 1) % 100000 == 0:
                print(f"  {i + 1} lines, {uniq} unique so far")
    size_mb = os.path.getsize(out) / (1024 * 1024)
    print(f"Done. {target} lines, {uniq} unique, {size_mb:.2f} MB -> {out}")


if __name__ == "__main__":
    main()
