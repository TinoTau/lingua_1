# 节点端日志级别优化说明

## 修改目的

减少节点端在终端窗口的打印日志，特别是像心跳一样频繁刷新的日志，让有效信息更容易看到。

## 已降低的日志级别

### 1. 心跳相关日志
**文件**: `electron_node/electron-node/main/src/agent/node-agent-heartbeat.ts`
- `Sending heartbeat with type-level capability` - 从 `info` 降为 `debug`
  - 原因：每15秒发送一次，非常频繁

**文件**: `electron_node/electron-node/main/src/agent/node-agent-services.ts`
- `Getting installed services for heartbeat (type-level)` - 从 `info` 降为 `debug`
  - 原因：每次心跳都会调用，非常频繁

### 2. 系统资源相关日志
**文件**: `electron_node/electron-node/main/src/system-resources.ts`
- `nvidia-smi command executed successfully` - 从 `info` 降为 `debug`
- `Parsed GPU info` - 从 `info` 降为 `debug`
- `nvidia-smi successfully returned GPU usage` - 从 `info` 降为 `debug`
  - 原因：每次获取系统资源都会调用，非常频繁

**文件**: `electron_node/electron-node/main/src/index.ts`
- `System resources fetched successfully` - 从 `info` 降为 `debug`
  - 原因：每次心跳都会获取系统资源

### 3. Model Hub 相关日志
**文件**: `electron_node/electron-node/main/src/model-manager/model-manager.ts`
- `Successfully fetched available models from Model Hub` - 从 `info` 降为 `debug`
  - 原因：每次心跳都会获取模型列表

### 4. 服务注册表相关日志
**文件**: `electron_node/electron-node/main/src/service-registry/index.ts`
- `Loading installed.json and replacing path placeholders` - 从 `info` 降为 `debug`
- `Path placeholder replacement successful` - 从 `info` 降为 `debug`
- `Service registry loaded` - 从 `info` 降为 `debug`
  - 原因：每次心跳都会加载服务注册表

### 5. 音频聚合器相关日志
**文件**: `electron_node/electron-node/main/src/pipeline-orchestrator/audio-aggregator.ts`
- `AudioAggregator: Audio chunk added to buffer` - 从 `info` 降为 `debug`
  - 原因：每个音频块都会触发，非常频繁

## 保留的日志级别

以下日志保持 `info` 级别，因为它们包含重要信息：

1. **错误和警告日志** - 全部保留 `error`/`warn` 级别
2. **任务处理日志** - 保留 `info` 级别（如 ASR 结果、NMT 结果等）
3. **服务启动/停止日志** - 保留 `info` 级别
4. **重要状态变化** - 保留 `info` 级别

## 如何查看 debug 日志

如果需要查看这些被降低的日志，可以：

1. **设置日志级别为 debug**：
   - 在环境变量中设置 `LOG_LEVEL=debug`
   - 或在代码中修改日志级别配置

2. **查看日志文件**：
   - 日志文件通常包含所有级别的日志
   - 位置：`electron_node/electron-node/logs/electron-main.log`

## 预期效果

- ✅ 终端输出大幅减少
- ✅ 心跳相关日志不再频繁刷新
- ✅ 系统资源、Model Hub、服务注册表相关日志不再频繁输出
- ✅ 音频块添加日志不再频繁输出
- ✅ 重要信息（错误、警告、任务处理）仍然可见

## 注意事项

- 所有错误和警告日志仍然保持原级别，不会丢失
- 如果需要调试，可以通过日志文件查看完整的 debug 级别日志
- 如果发现某些重要信息被隐藏，可以单独调整该日志的级别
