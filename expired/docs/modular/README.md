# 模块化功能文档

## 文档结构

本目录包含模块化功能实现的所有技术文档。

### 主要文档

- **[LINGUA_完整技术说明书_v2.md](./LINGUA_完整技术说明书_v2.md)** - 最终版本技术说明书（推荐阅读）
  - 包含完整的系统架构设计
  - 包含所有实现细节和规范
  - 包含方案演进历史、可行性评估、开发就绪性检查等附录

- **[MODULAR_FEATURES.md](./MODULAR_FEATURES.md)** - 快速参考文档
  - 模块化功能的快速参考
  - 使用示例和常见问题

### 历史文档（已合并到 v2 文档附录中）

以下文档的内容已合并到 `LINGUA_完整技术说明书_v2.md` 的附录中，保留作为参考：

- `LINGUA_完整技术说明书_v1.md` - v1 版本（历史参考）
- `LINGUA_模块热插拔方案可行性评估.md` - 可行性评估报告（已合并到附录 B）
- `LINGUA_v2开发就绪性检查.md` - 开发就绪性检查（已合并到附录 C）
- `COMPATIBILITY_CHECK_3.2.md` - 阶段 3.2 功能选择模块兼容性检查报告（已合并到附录 D）

## 实现状态

### ✅ 已完成

- 核心数据结构（ModuleMetadata, ModelRequirement, PipelineContext）
- MODULE_TABLE 模块配置表
- ModuleManager 增强（依赖检查、冲突检查、循环检测）
- capability_state 获取和上报机制
- PipelineContext 集成到 InferenceService
- 调度服务器的模块依赖展开算法
- 模块启用流程（模型加载逻辑，运行时根据任务需求动态启用）

### ⏸️ 待实现

- **可选模块模型集成**（待具体模型实现）
  - 音色识别、音色生成、语速识别、语速控制、情感检测、个性化适配
- **客户端功能选择 UI**（Web/移动端）
  - 由用户选择需要的功能，而不是节点端
- **节点端运行时模块管理**
  - 根据任务需求动态启用/禁用模块（无需 UI 开关）
- 模块配置持久化（P1）
- 模块性能监控（P2）
- 模块卸载超时配置（P1）

## 设计说明

**重要**：功能选择由 **Web/移动端的用户**决定，而不是节点端。

- **节点端职责**：下载模型、提供算力、根据任务需求动态启用模块
- **节点端 UI**：仅提供模型管理（下载/安装），不提供功能开关
- **客户端职责**：提供功能选择 UI，将用户选择包含在请求中

## 测试状态

- ✅ 单元测试：45/45 通过（100%）
  - 模块管理器测试：8/8 通过
  - 模块依赖解析器测试：10/10 通过
  - capability_state 测试：4/4 通过
  - 节点选择测试：6/6 通过
  - Web客户端功能选择测试：17/17 通过
- ⏸️ 集成测试：待进行
- ⏸️ 端到端测试：待进行

详细测试结果请参考：
- [Electron Node 测试报告](../../electron-node/tests/stage3.2/TEST_REPORT.md)
- [调度服务器节点选择测试报告](../../scheduler/tests/stage3.2/TEST_REPORT.md)
- [Web客户端功能选择测试报告](../../web-client/tests/stage3.2/TEST_REPORT.md)

## 快速开始

1. 阅读 [LINGUA_完整技术说明书_v2.md](./LINGUA_完整技术说明书_v2.md) 了解完整架构
2. 查看 [MODULAR_FEATURES.md](./MODULAR_FEATURES.md) 了解使用示例
3. 参考测试报告了解实现状态

